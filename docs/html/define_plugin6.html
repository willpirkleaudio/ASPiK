<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASPiK SDK: The Buffer Processing Cycle</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ASPiK SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('define_plugin6.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">The Buffer Processing Cycle </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The buffer processing cycle is complex but it is also defined and explained in high detail for AU, AAX, VST and the resulting ASPiK framework implementation in <b>Designing Audio Effects Plugins in C++</b>D 2nd Ed. by Will Pirkle so we won't go into major details here. The figure below shows the layout of a generic audio plugin's buffer processing cycle:<br  />
 </p><div class="image">
<img src="bufferproc.png" alt=""/>
</div>
<p> <br  />
 You can see from the above figure that the buffer processing cycle consists of three components: reading incoming parameter updates from the GUI controls, processing the audio, then writing output parameter information to the VU meters or other output-only controls. The <a class="el" href="class_plugin_base.html" title="The PluginBase object is the base class for the Plugin Core object.">PluginBase</a> defines three functions that correspond to this three-step architecture. These three functions will always be called in this exact order during each and every buffer processing cycle.</p>
<div class="fragment"><div class="line"><span class="comment">// --- preProcess: sync GUI parameters here   </span></div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">bool</span> preProcessAudioBuffers(<a class="code hl_struct" href="struct_process_buffer_info.html">ProcessBufferInfo</a>&amp; processInfo);      </div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- process buffers – the DSP   </span></div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">bool</span> processAudioBuffers(<a class="code hl_struct" href="struct_process_buffer_info.html">ProcessBufferInfo</a>&amp; processBufferInfo);      </div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- postProcess: do update meters, plots, graphs   </span></div>
<div class="line"><span class="keyword">virtual</span> <span class="keywordtype">bool</span> postProcessAudioBuffers(<a class="code hl_struct" href="struct_process_buffer_info.html">ProcessBufferInfo</a>&amp; processInfo);      </div>
<div class="line"><span class="comment">//</span></div>
<div class="ttc" id="astruct_process_buffer_info_html"><div class="ttname"><a href="struct_process_buffer_info.html">ProcessBufferInfo</a></div><div class="ttdoc">Information package that arrives with each new audio buffer process cycle. Contains everything needed...</div><div class="ttdef"><b>Definition:</b> pluginstructures.h:1123</div></div>
</div><!-- fragment --><p><b>Buffer Pre-Processing</b><br  />
 During the pre-processing phase, we make a single call to the function that synchronizes our plugin variables with the values stored in our plugin parameters. During this phase, it is impossible for the DAW, GUI or other entity to manipulate the parameters or the variables. The pre-processing function is:<br  />
</p>
<div class="fragment"><div class="line"><span class="comment">// --- do pre buffer processing   </span></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="class_plugin_core.html#a90fa43d29dbcb37c3fbaca6647dd492e">PluginCore::preProcessAudioBuffers</a>(<a class="code hl_struct" href="struct_process_buffer_info.html">ProcessBufferInfo</a>&amp; processInfo)      </div>
<div class="line">{   </div>
<div class="line">   <span class="comment">// --- sync internal variables to GUI parameters   </span></div>
<div class="line">   <a class="code hl_function" href="class_plugin_base.html#a53d3f0a290476d4313a18a5b1f7e8260">syncInBoundVariables</a>();      </div>
<div class="line">   <span class="keywordflow">return</span> <span class="keyword">true</span>;   </div>
<div class="line">}</div>
<div class="line"><span class="comment">//</span></div>
<div class="ttc" id="aclass_plugin_base_html_a53d3f0a290476d4313a18a5b1f7e8260"><div class="ttname"><a href="class_plugin_base.html#a53d3f0a290476d4313a18a5b1f7e8260">PluginBase::syncInBoundVariables</a></div><div class="ttdeci">void syncInBoundVariables()</div><div class="ttdoc">initialize object for a new run of audio; called just before audio streams</div><div class="ttdef"><b>Definition:</b> pluginbase.cpp:105</div></div>
<div class="ttc" id="aclass_plugin_core_html_a90fa43d29dbcb37c3fbaca6647dd492e"><div class="ttname"><a href="class_plugin_core.html#a90fa43d29dbcb37c3fbaca6647dd492e">PluginCore::preProcessAudioBuffers</a></div><div class="ttdeci">virtual bool preProcessAudioBuffers(ProcessBufferInfo &amp;processInfo)</div><div class="ttdoc">do anything needed prior to arrival of audio buffers</div><div class="ttdef"><b>Definition:</b> plugincore.cpp:103</div></div>
</div><!-- fragment --><p>The <em>syncInBoundVariables</em> method has two components. The first part simply copies the updated parameter information into the bound variables we supplied during the parameter instantiation. More importantly, this function calls a secondary function that allows you to do any post-update calculations. This base class function is implemented in the <a class="el" href="class_plugin_core.html" title="The PluginCore object is the default PluginBase derived object for ASPiK projects....">PluginCore</a>:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> postUpdatePluginParameter(int32_t controlID, <span class="keywordtype">double</span> controlValue, <a class="code hl_struct" href="struct_parameter_update_info.html">ParameterUpdateInfo</a>&amp; paramInfo);</div>
<div class="ttc" id="astruct_parameter_update_info_html"><div class="ttname"><a href="struct_parameter_update_info.html">ParameterUpdateInfo</a></div><div class="ttdoc">Information about a paraemeter being updated. Used when bound variables are updated....</div><div class="ttdef"><b>Definition:</b> pluginstructures.h:835</div></div>
</div><!-- fragment --><p>This function will be called for every parameter that is updated and will give you the chance to “cook” any variables that may need alteration as a result. We will demonstrate when you might use this function shortly. The incoming <a class="el" href="struct_parameter_update_info.html" title="Information about a paraemeter being updated. Used when bound variables are updated....">ParameterUpdateInfo</a> structure contains boolean flags that will indicate why this function was called. Once the pre-processing phase is complete, your plugin needs to be fully setup to process audio. We will show an example of using this function later.<br  />
 <br  />
 <b>Buffer Post-Processing</b><br  />
 The <em>postProcessAudioBuffers</em> method is called after all incoming buffers have been processed. The default implementation for this function is:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="class_plugin_core.html#ac89ad17043e4c76c20685a3f45a8c75f">PluginCore::postProcessAudioBuffers</a>(<a class="code hl_struct" href="struct_process_buffer_info.html">ProcessBufferInfo</a>&amp; processInfo)      </div>
<div class="line">{   </div>
<div class="line">   <span class="comment">// --- update outbound variables   </span></div>
<div class="line">   <a class="code hl_function" href="class_plugin_base.html#a28afc5f563995e922b126d19fd4c3656">updateOutBoundVariables</a>();      </div>
<div class="line">   <span class="keywordflow">return</span> <span class="keyword">true</span>;   </div>
<div class="line">}   </div>
<div class="ttc" id="aclass_plugin_base_html_a28afc5f563995e922b126d19fd4c3656"><div class="ttname"><a href="class_plugin_base.html#a28afc5f563995e922b126d19fd4c3656">PluginBase::updateOutBoundVariables</a></div><div class="ttdeci">bool updateOutBoundVariables()</div><div class="ttdoc">copy newly updated metering variables into GUI parameters for display</div><div class="ttdef"><b>Definition:</b> pluginbase.cpp:308</div></div>
<div class="ttc" id="aclass_plugin_core_html_ac89ad17043e4c76c20685a3f45a8c75f"><div class="ttname"><a href="class_plugin_core.html#ac89ad17043e4c76c20685a3f45a8c75f">PluginCore::postProcessAudioBuffers</a></div><div class="ttdeci">virtual bool postProcessAudioBuffers(ProcessBufferInfo &amp;processInfo)</div><div class="ttdoc">do anything needed prior to arrival of audio buffers</div><div class="ttdef"><b>Definition:</b> plugincore.cpp:411</div></div>
</div><!-- fragment --><p>This function simply calls the sub-function <em>updateOutboundVariables</em> which copies output parameter values into a special list that will be delivered back to the native parameter list, and then back to the GUI in a thread-safe manner. You won't need to modify or mess with that function, but this is the opportunity for your plugin to do any other processing after the buffer processing is completed. This would only include processing after ALL audio data has been processed.<br  />
<br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">ASPiK Developer&#39;s Guide</a></li><li class="navelem"><a class="el" href="simple_plugin.html">Write a Plugin</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
