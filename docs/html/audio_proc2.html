<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASPiK SDK: Audio Input and Output Samples</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ASPiK SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('audio_proc2.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Audio Input and Output Samples </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>We will need to decode the <a class="el" href="struct_channel_i_o_config.html" title="Structure of a pair of channel format enumerators that set an input/output channel I/O capability.">ChannelIOConfig</a> variable for the audio data and pick up the audio input data samples, process them, and then write our audio outputs into the <em>audioOutputFrame array</em> according to the output channel IO configuration. You may adapt this code as your plug requires it. The stock <em>processAudioFrame</em> function your plugin is created with looks something like this at the head of the function.</p>
<div class="fragment"><div class="line"><span class="comment">// --- fire any MIDI events for this sample interval   </span></div>
<div class="line">processFrameInfo.midiEventQueue-&gt;fireMidiEvents(processFrameInfo.currentFrame);      </div>
<div class="line">   </div>
<div class="line"><span class="comment">// --- do per-frame smoothing</span></div>
<div class="line">doParameterSmoothing();      </div>
<div class="line">   </div>
<div class="line"><span class="comment">// --- Synth or FX Plugin?   </span></div>
<div class="line"><span class="keywordflow">if</span> (getPluginType() == kFXPlugin)      </div>
<div class="line">{  </div>
<div class="line">   <span class="comment">// do FX stuff   </span></div>
<div class="line">}</div>
<div class="line"><span class="comment">//</span></div>
</div><!-- fragment --><p>From this point on, we will assume that we are processing for a FX plugin and we'll omit those enclosing curly brackets for brevity. All ASPiK plugins will by default accommodate mono-mono, mono-stereo and stereo-stereo formats. You can add more channel formats as you like. Each new blank ASPiK plugin will pass audio from input to output directly. You will then modify the code to do some meaningful processing. The audio data samples arrive in slots in the <em>audioInputFrame</em> and <em>audioOutputFrame</em> arrays and we use standard C++ array notation to access them. We might write something like this to pick up the input samples, process them through some interesting audio processing function then and pass the resulting samples to the outputs:</p>
<div class="fragment"><div class="line"><span class="comment">// --- get left and right input samples</span></div>
<div class="line"><span class="keywordtype">double</span> xn_L = processFrameInfo.audioInputFrame[0];</div>
<div class="line"><span class="keywordtype">double</span> xn_R = processFrameInfo.audioInputFrame[1];</div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- process them to create outputs</span></div>
<div class="line"><span class="keywordtype">double</span> yn_L = doSomeCoolAudioProcessing(xn_L);</div>
<div class="line"><span class="keywordtype">double</span> yn_R = doSomeCoolAudioProcessing(xn_R);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- send audio out</span></div>
<div class="line">processFrameInfo.audioOutputFrame[0] = yn_L;</div>
<div class="line">processFrameInfo.audioOutputFrame[1] = yn_R;</div>
<div class="line"><span class="comment">//</span></div>
</div><!-- fragment --><p>From this example, it should be obvious how to pick up input samples and write output samples. If we were processing a 5.1 input, we might write something like this instead:</p>
<div class="fragment"><div class="line"><span class="comment">// --- 5.1</span></div>
<div class="line"><span class="keywordtype">double</span> leftIn = processFrameInfo.audioInputFrame[0];</div>
<div class="line"><span class="keywordtype">double</span> rightIn = processFrameInfo.audioInputFrame[1];</div>
<div class="line"><span class="keywordtype">double</span> lfeIn =  processFrameInfo.audioInputFrame[2];</div>
<div class="line"><span class="keywordtype">double</span> leftSurroundIn = processFrameInfo.audioInputFrame[3];</div>
<div class="line"><span class="keywordtype">double</span> rightSurroundIn= processFrameInfo.audioInputFrame[4];</div>
<div class="line"><span class="comment">//</span></div>
</div><!-- fragment --><p>To decode our three I/O combinations, we use the following code:</p>
<div class="fragment"><div class="line"><span class="comment">// --- Mono-In/Mono-Out</span></div>
<div class="line"><span class="keywordflow">if</span>(processFrameInfo.channelIOConfig.inputChannelFormat == kCFMono &amp;&amp; </div>
<div class="line">   processFrameInfo.channelIOConfig.outputChannelFormat = kCFMono)</div>
<div class="line">{</div>
<div class="line">   <span class="comment">// --- DO mono-in --&gt; mono out processing</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- Mono-In/Stereo-Out</span></div>
<div class="line"><span class="keywordflow">if</span>(processFrameInfo.channelIOConfig.inputChannelFormat == kCFMono &amp;&amp;</div>
<div class="line">   processFrameInfo.channelIOConfig.outputChannelFormat == kCFStereo)</div>
<div class="line">{</div>
<div class="line">   <span class="comment">// --- DO mono-in --&gt; stereo out processing</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// --- Stereo-In/Stereo-Out</span></div>
<div class="line"><span class="keywordflow">if</span>(processFrameInfo.channelIOConfig.inputChannelFormat == kCFStereo &amp;&amp;</div>
<div class="line">   processFrameInfo.channelIOConfig.outputChannelFormat == kCFStereo)</div>
<div class="line">{</div>
<div class="line">   <span class="comment">// --- DO stereo-in --&gt; stereo out processing</span></div>
<div class="line">}</div>
<div class="line"><span class="comment">//</span></div>
</div><!-- fragment --><p>You can modify the channel decoding logic to suit your own taste. One thing to note is that this function (like all of the <a class="el" href="class_plugin_base.html" title="The PluginBase object is the base class for the Plugin Core object.">PluginBase</a> functions) returns a boolean variable to signify whether we actually processed data or not. We can return true from inside each of those curly bracket sets and return false if none of our channel combinations are supported. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">ASPiK Developer&#39;s Guide</a></li><li class="navelem"><a class="el" href="simple_plugin.html">Write a Plugin</a></li><li class="navelem"><a class="el" href="define_plugin8.html">Processing the Audio Data</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
