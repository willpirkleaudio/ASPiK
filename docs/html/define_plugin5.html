<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.6"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ASPiK SDK: Plugin Reset</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">ASPiK SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.6 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('define_plugin5.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Plugin Reset </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Before getting into details about audio processing, we need to think about what happens after the user loads the plugin, but before audio data streams through it. One of the most important pieces of information we need is the current sample rate of the audio that will be processed through the plugin. Knowing the sample rate is critical for many of our calculations. This usually includes filter coefficients and delay-buffer sizes. The various API's each provide a mechanism for retrieving the current sample rate and this will depend on the API manufacturer. In some systems, the sample rate might change during the course of a DAW session and in others it must be locked down and set prior to the sessions creation. In all cases, the sample rate will not change while the audio is streaming into the plugin. <br  />
<br  />
 The <a class="el" href="class_plugin_core.html" title="The PluginCore object is the default PluginBase derived object for ASPiK projects....">PluginCore</a> implements a reset function that is called during the plugin initialization, and then again any time the sample rate changes. It is also called in some APIs if the user stops and then restarts audio playback. There is some grey area here as well, based on how the DAW designers interpret the plugin API, or how the DAW itself operates and handles files with different sample rates. However, we can be sure that the reset function will be called at least once at initialization. You can find the reset function implementation in the <a class="el" href="plugincore_8cpp.html" title="Implementation file for PluginCore object.">plugincore.cpp</a> file just below the initPluginParameters( ) function. <br  />
<br  />
 When you create your project, the function will have a default implementation shown here:</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="class_plugin_core.html#abb761153a535c8726037fe0895e14618">PluginCore::reset</a>(<a class="code hl_struct" href="struct_reset_info.html">ResetInfo</a>&amp; resetInfo)      </div>
<div class="line">{   </div>
<div class="line">   <span class="comment">// --- save for audio processing   </span></div>
<div class="line">   <a class="code hl_variable" href="class_plugin_base.html#a7af099ef728cf71e39f1eb83c009686e">audioProcDescriptor</a>.<a class="code hl_variable" href="struct_audio_proc_descriptor.html#aabeec12d277ef4ee7158f7d34057297f">sampleRate</a> = resetInfo.<a class="code hl_variable" href="struct_reset_info.html#a7e649aef6c17a4d03fdfccd6cc9575b1">sampleRate</a>;      </div>
<div class="line">   <a class="code hl_variable" href="class_plugin_base.html#a7af099ef728cf71e39f1eb83c009686e">audioProcDescriptor</a>.<a class="code hl_variable" href="struct_audio_proc_descriptor.html#adb5e41a493cb37a2a289602662896dca">bitDepth</a> = resetInfo.<a class="code hl_variable" href="struct_reset_info.html#a5903757c8ece4cd1ccba6f558b7d0405">bitDepth</a>;      </div>
<div class="line">   </div>
<div class="line">   <span class="comment">// --- other reset inits   </span></div>
<div class="line">   <span class="keywordflow">return</span> <a class="code hl_function" href="class_plugin_base.html#af02b3cb8d504953938c6751cea2d28e5">PluginBase::reset</a>(resetInfo);   </div>
<div class="line">}   </div>
<div class="line"><span class="comment">//</span></div>
<div class="ttc" id="aclass_plugin_base_html_a7af099ef728cf71e39f1eb83c009686e"><div class="ttname"><a href="class_plugin_base.html#a7af099ef728cf71e39f1eb83c009686e">PluginBase::audioProcDescriptor</a></div><div class="ttdeci">AudioProcDescriptor audioProcDescriptor</div><div class="ttdoc">current audio processing description</div><div class="ttdef"><b>Definition:</b> pluginbase.h:417</div></div>
<div class="ttc" id="aclass_plugin_base_html_af02b3cb8d504953938c6751cea2d28e5"><div class="ttname"><a href="class_plugin_base.html#af02b3cb8d504953938c6751cea2d28e5">PluginBase::reset</a></div><div class="ttdeci">virtual bool reset(ResetInfo &amp;resetInfo)</div><div class="ttdoc">initialize object for a new run of audio; called just before audio streams</div><div class="ttdef"><b>Definition:</b> pluginbase.cpp:71</div></div>
<div class="ttc" id="aclass_plugin_core_html_abb761153a535c8726037fe0895e14618"><div class="ttname"><a href="class_plugin_core.html#abb761153a535c8726037fe0895e14618">PluginCore::reset</a></div><div class="ttdeci">virtual bool reset(ResetInfo &amp;resetInfo)</div><div class="ttdoc">initialize object for a new run of audio; called just before audio streams</div><div class="ttdef"><b>Definition:</b> plugincore.cpp:66</div></div>
<div class="ttc" id="astruct_audio_proc_descriptor_html_aabeec12d277ef4ee7158f7d34057297f"><div class="ttname"><a href="struct_audio_proc_descriptor.html#aabeec12d277ef4ee7158f7d34057297f">AudioProcDescriptor::sampleRate</a></div><div class="ttdeci">double sampleRate</div><div class="ttdoc">sample rate</div><div class="ttdef"><b>Definition:</b> pluginstructures.h:1237</div></div>
<div class="ttc" id="astruct_audio_proc_descriptor_html_adb5e41a493cb37a2a289602662896dca"><div class="ttname"><a href="struct_audio_proc_descriptor.html#adb5e41a493cb37a2a289602662896dca">AudioProcDescriptor::bitDepth</a></div><div class="ttdeci">uint32_t bitDepth</div><div class="ttdoc">wav file bit depth (not supported in all APIs)</div><div class="ttdef"><b>Definition:</b> pluginstructures.h:1238</div></div>
<div class="ttc" id="astruct_reset_info_html"><div class="ttname"><a href="struct_reset_info.html">ResetInfo</a></div><div class="ttdoc">Sample rate and bit-depth information that is passed during the reset( ) function.</div><div class="ttdef"><b>Definition:</b> pluginstructures.h:181</div></div>
<div class="ttc" id="astruct_reset_info_html_a5903757c8ece4cd1ccba6f558b7d0405"><div class="ttname"><a href="struct_reset_info.html#a5903757c8ece4cd1ccba6f558b7d0405">ResetInfo::bitDepth</a></div><div class="ttdeci">uint32_t bitDepth</div><div class="ttdoc">bit depth (not available in all APIs)</div><div class="ttdef"><b>Definition:</b> pluginstructures.h:192</div></div>
<div class="ttc" id="astruct_reset_info_html_a7e649aef6c17a4d03fdfccd6cc9575b1"><div class="ttname"><a href="struct_reset_info.html#a7e649aef6c17a4d03fdfccd6cc9575b1">ResetInfo::sampleRate</a></div><div class="ttdeci">double sampleRate</div><div class="ttdoc">sample rate</div><div class="ttdef"><b>Definition:</b> pluginstructures.h:191</div></div>
</div><!-- fragment --><p>The reset function argument is a <a class="el" href="struct_reset_info.html" title="Sample rate and bit-depth information that is passed during the reset( ) function.">ResetInfo</a> structure reference. This simple structure has only two members, one for the sample rate and one for the bit-depth. The bit-depth information is not available in all APIs, and is somewhat of a legacy attribute, dating back to the fixed-point processing days and early plugin APIs, so we will ignore it in our plugins here. However, if you are writing a plugin that needs to know if the audio file feeding it is 16-bit versus 24-bit and the API allows it, then you may use this information accordingly. You can see from the default implementation that the sample rate is stored on our <b>audioProcDescriptor</b> member variable, and <b>you can access this value at any time and from any function in the core</b>. <br  />
<br  />
 After storing the sample rate, your plugin may need to perform other resetting operations including:</p><ul>
<li>re-calculating filter coefficients based on a new sample rate</li>
<li>flushing delay registers and buffers of old audio data so it is not used during the next processing run</li>
<li>re-sizing buffers that are sample-rate dependent (like the circular buffers we use for delay and reverb plugins)</li>
<li>resetting pointers, index values or anything else to prepare for a fresh audio processing cycle <br  />
 Nothing in our volume plugin's functionality is going to require sample rate updates or resetting for fresh audio runs, so here we will not bother with it. However, in most of the plugin projects, there will be something to adjust based on the sample rate so we will include the reset function as part of the other audio processing function descriptions.<br  />
<br  />
 </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">ASPiK Developer&#39;s Guide</a></li><li class="navelem"><a class="el" href="simple_plugin.html">Write a Plugin</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.6 </li>
  </ul>
</div>
</body>
</html>
